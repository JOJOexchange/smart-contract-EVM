{"abi":[],"bytecode":{"object":"0x60566037600b82828239805160001a607314602a57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600080fdfea26469706673582212209b21bcce80b53ffcc83a5b122bc0da21dbca74c298f67315a054109ee98b3e6664736f6c63430008090033","sourceMap":"155:1169:22:-:0;;;;;;;;;;;;;;;-1:-1:-1;;;155:1169:22;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x73000000000000000000000000000000000000000030146080604052600080fdfea26469706673582212209b21bcce80b53ffcc83a5b122bc0da21dbca74c298f67315a054109ee98b3e6664736f6c63430008090033","sourceMap":"155:1169:22:-:0;;;;;;;;","linkReferences":{}},"methodIdentifiers":{},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.9+commit.e5eed63a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/lib/Position.sol\":\"Position\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@mean-finance/=node_modules/@mean-finance/\",\":@openzeppelin/=node_modules/@openzeppelin/\",\":@rari-capital/=node_modules/@rari-capital/\",\":@uniswap/=node_modules/@uniswap/\",\":base64-sol/=node_modules/base64-sol/\",\":ds-test/=lib/forge-std/lib/ds-test/src/\",\":eth-gas-reporter/=node_modules/eth-gas-reporter/\",\":forge-std/=lib/forge-std/src/\",\":hardhat-deploy/=node_modules/hardhat-deploy/\",\":hardhat/=node_modules/hardhat/\"]},\"sources\":{\"contracts/lib/Position.sol\":{\"keccak256\":\"0x56ba57f9292b3936f4d5f9abb2e45e34489d161b2fb747ebab78050945935df6\",\"license\":\"BUSL-1.1\",\"urls\":[\"bzz-raw://8feed0f66b4a799cfbaea5307c2db19ce0f940140262b8fc47c3b00ac4f744ef\",\"dweb:/ipfs/QmYJ836q4ukyVycaTkrqGs5dfP6AjzHkrQYkow17YCLHer\"]},\"contracts/lib/Types.sol\":{\"keccak256\":\"0x86ebf76724a433dea625290e0418c09b40387a17ef2917e4bbd2ccbec808fc96\",\"license\":\"BUSL-1.1\",\"urls\":[\"bzz-raw://d3af2e85ca328ed8e48ba00610d96ec0fb93c9df7ca2246aea64d6230354e662\",\"dweb:/ipfs/QmajVy2FCZXsyTcJinNHSEBwaz3FG8crGTKQFks59JmvfD\"]},\"contracts/utils/Errors.sol\":{\"keccak256\":\"0xa4834efefa19e042a4e12c49b13fc2df3a98cc5dce985f5fe6ab60a17a58c1dd\",\"license\":\"BUSL-1.1\",\"urls\":[\"bzz-raw://a8200bb591858e7aeedc38aa0aba1126383949cf22bca1e50fda7076e9d6cbb8\",\"dweb:/ipfs/Qme45peKW4sXnJK1KGzAYJXYWZ8q9zvFSBtAyzNr6j86dU\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.9+commit.e5eed63a"},"language":"Solidity","output":{"abi":[],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["@mean-finance/=node_modules/@mean-finance/","@openzeppelin/=node_modules/@openzeppelin/","@rari-capital/=node_modules/@rari-capital/","@uniswap/=node_modules/@uniswap/","base64-sol/=node_modules/base64-sol/","ds-test/=lib/forge-std/lib/ds-test/src/","eth-gas-reporter/=node_modules/eth-gas-reporter/","forge-std/=lib/forge-std/src/","hardhat-deploy/=node_modules/hardhat-deploy/","hardhat/=node_modules/hardhat/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"contracts/lib/Position.sol":"Position"},"libraries":{}},"sources":{"contracts/lib/Position.sol":{"keccak256":"0x56ba57f9292b3936f4d5f9abb2e45e34489d161b2fb747ebab78050945935df6","urls":["bzz-raw://8feed0f66b4a799cfbaea5307c2db19ce0f940140262b8fc47c3b00ac4f744ef","dweb:/ipfs/QmYJ836q4ukyVycaTkrqGs5dfP6AjzHkrQYkow17YCLHer"],"license":"BUSL-1.1"},"contracts/lib/Types.sol":{"keccak256":"0x86ebf76724a433dea625290e0418c09b40387a17ef2917e4bbd2ccbec808fc96","urls":["bzz-raw://d3af2e85ca328ed8e48ba00610d96ec0fb93c9df7ca2246aea64d6230354e662","dweb:/ipfs/QmajVy2FCZXsyTcJinNHSEBwaz3FG8crGTKQFks59JmvfD"],"license":"BUSL-1.1"},"contracts/utils/Errors.sol":{"keccak256":"0xa4834efefa19e042a4e12c49b13fc2df3a98cc5dce985f5fe6ab60a17a58c1dd","urls":["bzz-raw://a8200bb591858e7aeedc38aa0aba1126383949cf22bca1e50fda7076e9d6cbb8","dweb:/ipfs/Qme45peKW4sXnJK1KGzAYJXYWZ8q9zvFSBtAyzNr6j86dU"],"license":"BUSL-1.1"}},"version":1},"ast":{"absolutePath":"contracts/lib/Position.sol","id":5260,"exportedSymbols":{"Errors":[9268],"Position":[5259],"Types":[6020]},"nodeType":"SourceUnit","src":"78:1247:22","nodes":[{"id":5143,"nodeType":"PragmaDirective","src":"78:22:22","nodes":[],"literals":["solidity","0.8",".9"]},{"id":5144,"nodeType":"ImportDirective","src":"102:29:22","nodes":[],"absolutePath":"contracts/utils/Errors.sol","file":"../utils/Errors.sol","nameLocation":"-1:-1:-1","scope":5260,"sourceUnit":9269,"symbolAliases":[],"unitAlias":""},{"id":5145,"nodeType":"ImportDirective","src":"132:21:22","nodes":[],"absolutePath":"contracts/lib/Types.sol","file":"./Types.sol","nameLocation":"-1:-1:-1","scope":5260,"sourceUnit":6021,"symbolAliases":[],"unitAlias":""},{"id":5259,"nodeType":"ContractDefinition","src":"155:1169:22","nodes":[{"id":5178,"nodeType":"FunctionDefinition","src":"333:257:22","nodes":[],"body":{"id":5177,"nodeType":"Block","src":"408:182:22","nodes":[],"statements":[{"expression":{"arguments":[{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":5162,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"baseExpression":{"expression":{"id":5155,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5149,"src":"426:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5156,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"openPositions","nodeType":"MemberAccess","referencedDeclaration":5938,"src":"426:19:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_array$_t_address_$dyn_storage_$","typeString":"mapping(address => address[] storage ref)"}},"id":5158,"indexExpression":{"id":5157,"name":"trader","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5151,"src":"446:6:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"426:27:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage","typeString":"address[] storage ref"}},"id":5159,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"length","nodeType":"MemberAccess","src":"426:34:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<","rightExpression":{"expression":{"id":5160,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5149,"src":"463:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5161,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"maxPositionAmount","nodeType":"MemberAccess","referencedDeclaration":5970,"src":"463:23:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"426:60:22","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},{"expression":{"id":5163,"name":"Errors","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":9268,"src":"488:6:22","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Errors_$9268_$","typeString":"type(library Errors)"}},"id":5164,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"POSITION_AMOUNT_REACH_UPPER_LIMIT","nodeType":"MemberAccess","referencedDeclaration":9267,"src":"488:40:22","typeDescriptions":{"typeIdentifier":"t_string_memory_ptr","typeString":"string memory"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_string_memory_ptr","typeString":"string memory"}],"id":5154,"name":"require","nodeType":"Identifier","overloadedDeclarations":[-18,-18],"referencedDeclaration":-18,"src":"418:7:22","typeDescriptions":{"typeIdentifier":"t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$","typeString":"function (bool,string memory) pure"}},"id":5165,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"418:111:22","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":5166,"nodeType":"ExpressionStatement","src":"418:111:22"},{"expression":{"arguments":[{"expression":{"id":5173,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"572:3:22","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":5174,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"sender","nodeType":"MemberAccess","src":"572:10:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"}],"expression":{"baseExpression":{"expression":{"id":5167,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5149,"src":"539:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5170,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"openPositions","nodeType":"MemberAccess","referencedDeclaration":5938,"src":"539:19:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_array$_t_address_$dyn_storage_$","typeString":"mapping(address => address[] storage ref)"}},"id":5171,"indexExpression":{"id":5169,"name":"trader","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5151,"src":"559:6:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"539:27:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage","typeString":"address[] storage ref"}},"id":5172,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"push","nodeType":"MemberAccess","src":"539:32:22","typeDescriptions":{"typeIdentifier":"t_function_arraypush_nonpayable$_t_array$_t_address_$dyn_storage_ptr_$_t_address_$returns$__$bound_to$_t_array$_t_address_$dyn_storage_ptr_$","typeString":"function (address[] storage pointer,address)"}},"id":5175,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"539:44:22","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":5176,"nodeType":"ExpressionStatement","src":"539:44:22"}]},"documentation":{"id":5146,"nodeType":"StructuredDocumentation","src":"226:102:22","text":"@notice add position when trade or liquidation happen\n msg.sender is the perpetual contract"},"implemented":true,"kind":"function","modifiers":[],"name":"_openPosition","nameLocation":"342:13:22","parameters":{"id":5152,"nodeType":"ParameterList","parameters":[{"constant":false,"id":5149,"mutability":"mutable","name":"state","nameLocation":"376:5:22","nodeType":"VariableDeclaration","scope":5178,"src":"356:25:22","stateVariable":false,"storageLocation":"storage","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State"},"typeName":{"id":5148,"nodeType":"UserDefinedTypeName","pathNode":{"id":5147,"name":"Types.State","nodeType":"IdentifierPath","referencedDeclaration":5971,"src":"356:11:22"},"referencedDeclaration":5971,"src":"356:11:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State"}},"visibility":"internal"},{"constant":false,"id":5151,"mutability":"mutable","name":"trader","nameLocation":"391:6:22","nodeType":"VariableDeclaration","scope":5178,"src":"383:14:22","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":5150,"name":"address","nodeType":"ElementaryTypeName","src":"383:7:22","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"}],"src":"355:43:22"},"returnParameters":{"id":5153,"nodeType":"ParameterList","parameters":[],"src":"408:0:22"},"scope":5259,"stateMutability":"nonpayable","virtual":false,"visibility":"internal"},{"id":5258,"nodeType":"FunctionDefinition","src":"707:615:22","nodes":[],"body":{"id":5257,"nodeType":"Block","src":"822:500:22","nodes":[],"statements":[{"expression":{"id":5195,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"baseExpression":{"expression":{"id":5189,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5182,"src":"832:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5192,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"primaryCredit","nodeType":"MemberAccess","referencedDeclaration":5895,"src":"832:19:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_int256_$","typeString":"mapping(address => int256)"}},"id":5193,"indexExpression":{"id":5191,"name":"trader","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5184,"src":"852:6:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":true,"nodeType":"IndexAccess","src":"832:27:22","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"nodeType":"Assignment","operator":"+=","rightHandSide":{"id":5194,"name":"pnl","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5186,"src":"863:3:22","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"src":"832:34:22","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"id":5196,"nodeType":"ExpressionStatement","src":"832:34:22"},{"expression":{"id":5206,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"baseExpression":{"baseExpression":{"expression":{"id":5197,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5182,"src":"876:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5202,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"positionSerialNum","nodeType":"MemberAccess","referencedDeclaration":5944,"src":"876:23:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_mapping$_t_address_$_t_uint256_$_$","typeString":"mapping(address => mapping(address => uint256))"}},"id":5203,"indexExpression":{"id":5199,"name":"trader","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5184,"src":"900:6:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"876:31:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_uint256_$","typeString":"mapping(address => uint256)"}},"id":5204,"indexExpression":{"expression":{"id":5200,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"908:3:22","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":5201,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"sender","nodeType":"MemberAccess","src":"908:10:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":true,"nodeType":"IndexAccess","src":"876:43:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"+=","rightHandSide":{"hexValue":"31","id":5205,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"923:1:22","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"src":"876:48:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":5207,"nodeType":"ExpressionStatement","src":"876:48:22"},{"assignments":[5212],"declarations":[{"constant":false,"id":5212,"mutability":"mutable","name":"positionList","nameLocation":"953:12:22","nodeType":"VariableDeclaration","scope":5257,"src":"935:30:22","stateVariable":false,"storageLocation":"storage","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[]"},"typeName":{"baseType":{"id":5210,"name":"address","nodeType":"ElementaryTypeName","src":"935:7:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":5211,"nodeType":"ArrayTypeName","src":"935:9:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[]"}},"visibility":"internal"}],"id":5217,"initialValue":{"baseExpression":{"expression":{"id":5213,"name":"state","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5182,"src":"968:5:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State storage pointer"}},"id":5214,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"memberName":"openPositions","nodeType":"MemberAccess","referencedDeclaration":5938,"src":"968:19:22","typeDescriptions":{"typeIdentifier":"t_mapping$_t_address_$_t_array$_t_address_$dyn_storage_$","typeString":"mapping(address => address[] storage ref)"}},"id":5216,"indexExpression":{"id":5215,"name":"trader","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5184,"src":"988:6:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"968:27:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage","typeString":"address[] storage ref"}},"nodeType":"VariableDeclarationStatement","src":"935:60:22"},{"body":{"id":5255,"nodeType":"Block","src":"1051:265:22","statements":[{"condition":{"commonType":{"typeIdentifier":"t_address","typeString":"address"},"id":5231,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"baseExpression":{"id":5226,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1069:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5228,"indexExpression":{"id":5227,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5219,"src":"1082:1:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"1069:15:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"BinaryOperation","operator":"==","rightExpression":{"expression":{"id":5229,"name":"msg","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":-15,"src":"1088:3:22","typeDescriptions":{"typeIdentifier":"t_magic_message","typeString":"msg"}},"id":5230,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"sender","nodeType":"MemberAccess","src":"1088:10:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"1069:29:22","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":5250,"nodeType":"IfStatement","src":"1065:182:22","trueBody":{"id":5249,"nodeType":"Block","src":"1100:147:22","statements":[{"expression":{"id":5241,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"baseExpression":{"id":5232,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1118:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5234,"indexExpression":{"id":5233,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5219,"src":"1131:1:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":true,"nodeType":"IndexAccess","src":"1118:15:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"baseExpression":{"id":5235,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1136:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5240,"indexExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":5239,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"expression":{"id":5236,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1149:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5237,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"length","nodeType":"MemberAccess","src":"1149:19:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"hexValue":"31","id":5238,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1171:1:22","typeDescriptions":{"typeIdentifier":"t_rational_1_by_1","typeString":"int_const 1"},"value":"1"},"src":"1149:23:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"nodeType":"IndexAccess","src":"1136:37:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"src":"1118:55:22","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"id":5242,"nodeType":"ExpressionStatement","src":"1118:55:22"},{"expression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":5243,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1191:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5245,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"pop","nodeType":"MemberAccess","src":"1191:16:22","typeDescriptions":{"typeIdentifier":"t_function_arraypop_nonpayable$_t_array$_t_address_$dyn_storage_ptr_$returns$__$bound_to$_t_array$_t_address_$dyn_storage_ptr_$","typeString":"function (address[] storage pointer)"}},"id":5246,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"1191:18:22","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$__$","typeString":"tuple()"}},"id":5247,"nodeType":"ExpressionStatement","src":"1191:18:22"},{"id":5248,"nodeType":"Break","src":"1227:5:22"}]}},{"id":5254,"nodeType":"UncheckedBlock","src":"1260:46:22","statements":[{"expression":{"id":5252,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"nodeType":"UnaryOperation","operator":"++","prefix":true,"src":"1288:3:22","subExpression":{"id":5251,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5219,"src":"1290:1:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":5253,"nodeType":"ExpressionStatement","src":"1288:3:22"}]}]},"condition":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":5225,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":5222,"name":"i","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5219,"src":"1025:1:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"<","rightExpression":{"expression":{"id":5223,"name":"positionList","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5212,"src":"1029:12:22","typeDescriptions":{"typeIdentifier":"t_array$_t_address_$dyn_storage_ptr","typeString":"address[] storage pointer"}},"id":5224,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"length","nodeType":"MemberAccess","src":"1029:19:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"1025:23:22","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"id":5256,"initializationExpression":{"assignments":[5219],"declarations":[{"constant":false,"id":5219,"mutability":"mutable","name":"i","nameLocation":"1018:1:22","nodeType":"VariableDeclaration","scope":5256,"src":"1010:9:22","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":5218,"name":"uint256","nodeType":"ElementaryTypeName","src":"1010:7:22","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":5221,"initialValue":{"hexValue":"30","id":5220,"isConstant":false,"isLValue":false,"isPure":true,"kind":"number","lValueRequested":false,"nodeType":"Literal","src":"1022:1:22","typeDescriptions":{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"},"value":"0"},"nodeType":"VariableDeclarationStatement","src":"1010:13:22"},"nodeType":"ForStatement","src":"1005:311:22"}]},"documentation":{"id":5179,"nodeType":"StructuredDocumentation","src":"596:106:22","text":"@notice realize pnl and remove position from the registry\n msg.sender is the perpetual contract"},"implemented":true,"kind":"function","modifiers":[],"name":"_realizePnl","nameLocation":"716:11:22","parameters":{"id":5187,"nodeType":"ParameterList","parameters":[{"constant":false,"id":5182,"mutability":"mutable","name":"state","nameLocation":"757:5:22","nodeType":"VariableDeclaration","scope":5258,"src":"737:25:22","stateVariable":false,"storageLocation":"storage","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State"},"typeName":{"id":5181,"nodeType":"UserDefinedTypeName","pathNode":{"id":5180,"name":"Types.State","nodeType":"IdentifierPath","referencedDeclaration":5971,"src":"737:11:22"},"referencedDeclaration":5971,"src":"737:11:22","typeDescriptions":{"typeIdentifier":"t_struct$_State_$5971_storage_ptr","typeString":"struct Types.State"}},"visibility":"internal"},{"constant":false,"id":5184,"mutability":"mutable","name":"trader","nameLocation":"780:6:22","nodeType":"VariableDeclaration","scope":5258,"src":"772:14:22","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":5183,"name":"address","nodeType":"ElementaryTypeName","src":"772:7:22","stateMutability":"nonpayable","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"visibility":"internal"},{"constant":false,"id":5186,"mutability":"mutable","name":"pnl","nameLocation":"803:3:22","nodeType":"VariableDeclaration","scope":5258,"src":"796:10:22","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"},"typeName":{"id":5185,"name":"int256","nodeType":"ElementaryTypeName","src":"796:6:22","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"visibility":"internal"}],"src":"727:85:22"},"returnParameters":{"id":5188,"nodeType":"ParameterList","parameters":[],"src":"822:0:22"},"scope":5259,"stateMutability":"nonpayable","virtual":false,"visibility":"internal"}],"abstract":false,"baseContracts":[],"canonicalName":"Position","contractDependencies":[],"contractKind":"library","fullyImplemented":true,"linearizedBaseContracts":[5259],"name":"Position","nameLocation":"163:8:22","scope":5260,"usedErrors":[]}],"license":"BUSL-1.1"},"id":22}